# Stroom Content

_Stroom Content_ is a repository of the content definition files used to import entities into _Stroom_. Entities are such things as XML Schemas, XSLT translations, data splitter definitions, pipelines, dashboards, visualisations, etc. This repository provides a means to share common _Stroom_ content in a form that can be imported into multiple instances of _Stroom_.

The content is grouped into a number of _content packs_ which can each be built into a zip file that is ready for import directly into _Stroom_.

## Content pack contents

The following content packs are currently available.  Click on the link for details of what is in each content pack.

[**core-xml-schemas**](./docs/core-xml-schemas.md) - The core XML Schemas required by Stroom for basic operation.

[**event-logging-xml-schema**](./docs/event-logging-xml-schema.md) - An XML Schema standard for describing audit events.

[**internal-dashboards**](./docs/internal-dashboards.md) - A set of _Dashboard_ entities for displaying various metrics about the state of the _Stroom_ application and the underlying hardware and file systems.

[**internal-statistics**](./docs/internal-statistics.md) - A set of _StatisticStore_ entities for representing the internal statistics generated by Stroom.

[**standard-pipelines**](./docs/standard-pipelines.md) - A set of standard data format agnostic pipelines for processing data.

[**standard-translations**](./docs/standard-translations.md) - A set of standard parsers and translations for converting bespoke log formats in event-logging XML.

[**stroom-101**](./docs/stroom-101.md) - The entities used in the [quick start guide](https://gchq.github.io/stroom-docs/quick-start-guide/quick-start.html) 

[**template-pipelines**](./docs/template-pipelines.md) - A set of template pipelines that other pipelines can inherit from.

## Building the content packs

Each content pack is defined as a directory within _stroom-content-source_ with the name of content pack being the name of the directory.

The content packs can be built into the zip files by running the python script _buildContentPacks.py_. You can either build all packs or a list of named packs and you can choose to have them packaged as single combined zip or one per pack.

For example:

```bash
#build all packs into a single zip
./buildContentPacks.py --combine --all 

#build all packs, one zip per pack
./buildContentPacks.py  --all 

#build a named list of packs
./buildContentPacks.py  stroom-101 core-xml-schemas
```

## Released content packs

For a set of pre-built content packs see the [releases page](https://github.com/gchq/stroom-content/releases).

## Importing the content packs

The content pack zip files can be imported into _Stroom_ by selecting _Import_ from the _Tools_ menu.

## Developing Content

The _Stroom_ entities defined within _stroom-content-source/_ are all serialised forms, with XML as the serialisation format. Some entities consist of two files, one for the core entity and one for any significant payload, e.g. XSLT, JavaScript, JSON, etc. It is not recommended to create these entities by hand. The easiest way to create new content or to amend existing content is from within _Stroom_ and then use the Export function to export the content to its serialised form for inclusion in _stroom-content_.

### A word about UUIDs and dependencies

Each _Stroom_ entity is identified by a [Universally Unique Identifier](https://en.wikipedia.org/wiki/Universally_unique_identifier).  Where entities have dependencies on other entities, e.g. a _Dashboard_ entity depends on a _StatisticStore_ entity, this dependency relationship is defined by the UUID of the dependency entity. It is possible to import content into _Stroom_ with missing dependencies as this can sometimes be a valid use case, though with missing dependencies the entities will not work correctly until the dependencies are resolved, e.g. by updating the dependency.

All the entities defined in these content packs are defined with hard coded UUIDs and dependencies.  It is therefore **critical** that the correct UUIDs are used in the entity and dependency definitions in the XML.

It is likely that a content pack will contain entities that depend on entities in other content packs. This is so that we can have some common entities, e.g. template pipelines, that can be used by multiple packs, with the intention that only those packs that are needed are imported.

### Duplication between packs

It is possible for multiple packs to include the Folder entities with the same path structure, however they **must** have the same UUID. Duplication of other entity types should be avoided.

### Creating new content

New content should be crafted in _Stroom_, ideally an empty development instance of _Stroom_. If the new content relies on any entities from other content packs then these should first be imported into _Stroom_ so that the dependencies can be correctly defined. The new content should be created in the chosen folder structure. Once the content has been created, use the _Export_ function to export the folder(s) that contains it.

The _Export_ function will create a zip file containing all the serialised entities complete with the original path structure. You should create a directory under _stroom-content-source/_ with the name being the name of the content-pack. The content of the zip file should be unzipped into this directory. 

### Modifying existing content
